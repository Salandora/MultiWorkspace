buildscript {
    repositories {
        maven { url = "https://maven.fabricmc.net/" }
    }
}

plugins {
    id "fabric-loom" version "1.5-SNAPSHOT" apply false
}

allprojects  { p ->
    if (p == rootProject || p.name == "workspace") {
        return
    }

    tasks.withType(GenerateModuleMetadata).configureEach {
        enabled = false
    }

    tasks.withType(Test).configureEach {
        workingDir project(":workspace").relativePath("run/test_client")
    }

    apply plugin: "fabric-loom"

    dependencies {
        minecraft("com.mojang:minecraft:$minecraft_version")
    }

    project(":workspace") {
        afterEvaluate {
            it.moduleDependency(p)
        }
    }
}
